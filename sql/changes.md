# データベース変更履歴

## 2023-05-03
- ユーザープロファイルテーブル追加（`user_profiles.sql`）
  - 管理者、開発者、無料版、Pro版などのユーザー属性管理用
  - ユーザーの役割(role)とプラン情報(plan_type)を格納
  - セキュリティポリシーを設定：
    - ユーザーは自分のプロファイルのみ参照・更新可能
    - 管理者はすべてのプロファイルにアクセス可能
  - 適用: 開発(5/3)

## 2023-05-03 - ユーザー属性管理機能の追加
- ユーザー属性管理機能の実装
  - SignupFormの修正：サインアップ時にプロファイル自動作成
  - useUserRoleフック追加：ユーザーの役割とプラン情報の取得
  - RoleGuard, ProFeature, AdminOnly, DeveloperOnlyコンポーネント実装
  - 管理者ダッシュボードと管理画面の追加
  - ヘッダーに管理者/開発者メニューの追加

## 2025-05-03 - ユーザー論理削除・物理削除機能の追加
- ユーザープロファイルテーブルに論理削除フィールド追加（`add_deleted_at_field.sql`）
  - deleted_at列の追加：論理削除されたユーザーの削除日時を格納
  - インデックス追加：deleted_at列でのクエリ高速化
  - RLSポリシーの調整：通常ユーザーには削除済みユーザーを非表示にする
  - 管理者向けユーザー管理機能に削除操作を追加：
    - 論理削除：ユーザーを一時的に無効化（削除済みとしてマーク）
    - 物理削除：データベースからユーザー情報を完全に削除
    - 復元機能：論理削除されたユーザーを復活させる
  - 削除済みユーザー表示切替機能：管理者が削除済みユーザーを確認できる
