# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆã€ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã‚’çµ±åˆã—ãŸãƒ•ãƒªãƒ¼ãƒŸã‚¢ãƒ å‹ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚æ—¢å­˜ã®ã€Œãã‚‰ãµã„ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ©Ÿèƒ½ã‚’ç¶™æ‰¿ã—ã€ã•ã‚‰ã«æ‹¡å¼µã—ã¦ã„ãã¾ã™ã€‚

## ç›®æ¬¡

- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](#ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦)
- [æ©Ÿèƒ½ä¸€è¦§](#æ©Ÿèƒ½ä¸€è¦§)
- [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
- [é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ](#ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ )
- [å®Ÿè£…çŠ¶æ³](#å®Ÿè£…çŠ¶æ³)
- [é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—](#é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—)
- [é–‹ç™ºã‚¬ã‚¤ãƒ‰](#é–‹ç™ºã‚¬ã‚¤ãƒ‰)
- [ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰](#ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰)

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€Next.jsã€Supabaseã€Dockerã€Cloudflare Pagesã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰ã•ã‚ŒãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆã§ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã‚ŠãªãŒã‚‰ã€è¦–è¦šçš„ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ã€ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ãƒ»å…±æœ‰ã§ãã¾ã™ã€‚åŸºæœ¬æ©Ÿèƒ½ã¯ç„¡æ–™ã§æä¾›ã—ã€é«˜åº¦ãªæ©Ÿèƒ½ã‚’æœ‰æ–™ãƒ—ãƒ©ãƒ³ã¨ã—ã¦æä¾›ã™ã‚‹ãƒ•ãƒªãƒ¼ãƒŸã‚¢ãƒ ãƒ¢ãƒ‡ãƒ«ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

## æ©Ÿèƒ½ä¸€è¦§

### ç¶™æ‰¿ã•ã‚Œã‚‹ã€Œãã‚‰ãµã„ã€ã®æ©Ÿèƒ½
- **ãƒãƒ¼ãƒ¢ãƒã‚°ãƒ©ãƒ•**: æŒ¯ã‚Šå­ã®å‹•ããŒç”Ÿã¿å‡ºã™ç¾ã—ã„å¹¾ä½•å­¦æ¨¡æ§˜
- **ãƒ©ã‚¤ãƒ•ã‚²ãƒ¼ãƒ **: ã‚»ãƒ«ã‚ªãƒ¼ãƒˆãƒãƒˆãƒ³ã«ã‚ˆã‚‹ç”Ÿå‘½ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- **æƒ‘æ˜Ÿè»Œé“ï¼ˆæ˜ŸãŸã¡ã®ãƒ€ãƒ³ã‚¹ï¼‰**: æƒ‘æ˜Ÿã®è»Œé“ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è¦–è¦šåŒ–
- **ã‚ªã‚¤ãƒ©ãƒ¼ã®å…¬å¼ 3Dã‚°ãƒ©ãƒ•**: æ•°å­¦çš„å…¬å¼ã®3Dè¦–è¦šåŒ–
- **ãã®ä»–ã®ãƒ„ãƒ¼ãƒ«**: åå­—ã‚°ãƒ©ãƒ•ã€ç”Ÿå­˜æˆ¦ç•¥ã‚²ãƒ¼ãƒ ãªã©

### æ–°ãŸã«é–‹ç™ºã™ã‚‹æ©Ÿèƒ½
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼é–“ã§ã®ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- **ãƒ¡ãƒ¢æ©Ÿèƒ½**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ãƒ¡ãƒ¢ä½œæˆãƒ»ç®¡ç†ã€å…¬é–‹ãƒ»éå…¬é–‹è¨­å®š
- **ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«**: JSONæ•´å½¢ã€QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãªã©
- **å…±æœ‰ãƒ»å”åƒæ©Ÿèƒ½**: ãƒ„ãƒ¼ãƒ«ã®å…±åŒç·¨é›†ã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å…±æœ‰
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«**: ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ãªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
- **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚®ãƒ£ãƒ©ãƒªãƒ¼**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œå“ã®å…±æœ‰ã¨é–²è¦§

### ç„¡æ–™æ©Ÿèƒ½ã¨æœ‰æ–™æ©Ÿèƒ½ã®åŒºåˆ†
- **ç„¡æ–™æ©Ÿèƒ½**: åŸºæœ¬çš„ãªãƒ„ãƒ¼ãƒ«ã€ã‚·ãƒ³ãƒ—ãƒ«ãªãƒãƒ£ãƒƒãƒˆã€åŸºæœ¬çš„ãªå…±æœ‰æ©Ÿèƒ½
- **æœ‰æ–™æ©Ÿèƒ½**: é«˜åº¦ãªãƒ„ãƒ¼ãƒ«è¨­å®šã€ç„¡åˆ¶é™ã®å±¥æ­´ä¿å­˜ã€ãƒãƒ¼ãƒ æ©Ÿèƒ½ã€é«˜åº¦ãªå”åƒãƒ„ãƒ¼ãƒ«

è©³ç´°ãªæ©Ÿèƒ½ãƒãƒƒãƒ—ã¯ `docs/platform_mindmap.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js 14.1.3ï¼ˆReact 18ï¼‰ã€TailwindCSS
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Next.jsã®`use server`æ©Ÿèƒ½ + Supabase API
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Supabaseï¼ˆPostgreSQLï¼‰
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½**: Supabaseãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
- **èªè¨¼**: Supabase Auth
- **é–‹ç™ºç’°å¢ƒ**: Dockerã€Docker Compose
- **ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ**: Cloudflare Pages
- **è¨€èª**: TypeScript
- **ãƒ­ãƒ¼ã‚«ãƒ«å…¬é–‹**: ngrokï¼ˆé–‹ç™ºç’°å¢ƒã®å¤–éƒ¨å…¬é–‹ï¼‰

## é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Docker ã¨ Docker Compose ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- Git ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- Supabaseã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆæ¸ˆã¿
- ngrokã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆç„¡æ–™ã¾ãŸã¯æœ‰æ–™ãƒ—ãƒ©ãƒ³ï¼‰

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹
   ```bash
   git clone <repository-url>
   cd graph_e_rc2
   ```

2. ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­å®šã™ã‚‹
   ```bash
   cp .env.example .env
   # .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦å¿…è¦ãªç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹
   ```

   å¿…é ˆã®ç’°å¢ƒå¤‰æ•°:
   - `NEXT_PUBLIC_SUPABASE_URL`: Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®URL
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Supabaseã®åŒ¿åã‚­ãƒ¼
   - `NGROK_AUTHTOKEN`: ngrokã®èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆå¤–éƒ¨å…¬é–‹ã«å¿…è¦ï¼‰

3. Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦èµ·å‹•ã™ã‚‹
   ```bash
   docker-compose up -d
   ```

4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
   - Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³
   - SQLã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ã
   - `/sql/scripts/user_profiles.sql` ã®å†…å®¹ã‚’å®Ÿè¡Œ
   - å¿…è¦ã«å¿œã˜ã¦ `/sql/scripts/notes_table.sql` ã‚’å®Ÿè¡Œ

5. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
   ```
   http://localhost:3000  # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“
   http://localhost:4040  # ngrokç®¡ç†ãƒ‘ãƒãƒ«ï¼ˆå¤–éƒ¨å…¬é–‹URLç¢ºèªç”¨ï¼‰
   ```

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
graph_e_rc2/
â”œâ”€â”€ docs/                   # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ platform_mindmap.md # æ©Ÿèƒ½ãƒã‚¤ãƒ³ãƒ‰ãƒãƒƒãƒ—
â”‚   â”œâ”€â”€ platform_concept.md # ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ã‚»ãƒ—ãƒˆè©³ç´°
â”‚   â”œâ”€â”€ existing_features.md # æ—¢å­˜ã€Œãã‚‰ãµã„ã€æ©Ÿèƒ½ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹
â”‚   â””â”€â”€ supabase_storage_setup.md # Supabaseã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è¨­å®šæ‰‹é †
â”œâ”€â”€ sql/                    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ schema.sql          # æœ€æ–°ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
â”‚   â”œâ”€â”€ changes.md          # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¤‰æ›´å±¥æ­´
â”‚   â””â”€â”€ scripts/            # å®Ÿè¡Œç”¨SQLã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ src/                    # ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ app/                # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ admin/          # ç®¡ç†è€…æ©Ÿèƒ½
â”‚   â”‚   â”œâ”€â”€ auth/           # èªè¨¼é–¢é€£ã®ãƒ«ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ chat/           # ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½
â”‚   â”‚   â”œâ”€â”€ games/          # ã‚²ãƒ¼ãƒ æ©Ÿèƒ½
â”‚   â”‚   â”œâ”€â”€ login/          # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ notes/          # ãƒ¡ãƒ¢æ©Ÿèƒ½
â”‚   â”‚   â”‚   â”œâ”€â”€ [id]/       # ãƒ¡ãƒ¢è©³ç´°ãƒ»ç·¨é›†ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”‚   â””â”€â”€ new/        # æ–°è¦ãƒ¡ãƒ¢ä½œæˆãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ settings/       # è¨­å®šç”»é¢
â”‚   â”‚   â”‚   â””â”€â”€ profile/    # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®š
â”‚   â”‚   â””â”€â”€ signup/         # ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ components/         # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ auth/           # èªè¨¼é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ notes/          # ãƒ¡ãƒ¢é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ profile/        # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ui/             # å…±é€šUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ Header.tsx      # ãƒ˜ãƒƒãƒ€ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ config/             # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”‚   â””â”€â”€ avatars.ts      # ã‚¢ãƒã‚¿ãƒ¼è¨­å®š
â”‚   â”œâ”€â”€ hooks/              # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ useUserRole.ts  # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†ãƒ•ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ useProfile.ts   # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç®¡ç†ãƒ•ãƒƒã‚¯
â”‚   â”‚   â””â”€â”€ useNotes.ts     # ãƒ¡ãƒ¢ç®¡ç†ãƒ•ãƒƒã‚¯
â”‚   â”œâ”€â”€ lib/                # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â””â”€â”€ supabase.ts     # Supabaseè¨­å®š
â”‚   â””â”€â”€ types/              # å‹å®šç¾©
â”‚       â”œâ”€â”€ profile.ts      # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«é–¢é€£ã®å‹å®šç¾©
â”‚       â””â”€â”€ note.ts         # ãƒ¡ãƒ¢é–¢é€£ã®å‹å®šç¾©
â”œâ”€â”€ public/                 # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ avatars/            # ã‚¢ãƒã‚¿ãƒ¼ç”»åƒ
â”‚       â””â”€â”€ samples/        # ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒã‚¿ãƒ¼
â”œâ”€â”€ config/                 # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ bkup/                   # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ docker-compose.yml      # Docker Composeè¨­å®š
â”œâ”€â”€ Dockerfile              # Dockerãƒ“ãƒ«ãƒ‰è¨­å®š
â””â”€â”€ .env.example            # ç’°å¢ƒå¤‰æ•°ã‚µãƒ³ãƒ—ãƒ«
```

## å®Ÿè£…çŠ¶æ³

### å®Œäº†æ¸ˆã¿æ©Ÿèƒ½
âœ… åŸºæœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—  
âœ… Dockeré–‹ç™ºç’°å¢ƒã®æ§‹ç¯‰  
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã€ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆï¼‰  
âœ… èªè¨¼ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆï¼ˆProtectedRouteï¼‰  
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§ç®¡ç†ï¼ˆãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼‰  
âœ… ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®åŸºæœ¬UI  
âœ… RLSãƒãƒªã‚·ãƒ¼ã®è¨­å®šã¨ä¿®æ­£  
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ©Ÿèƒ½ï¼ˆè¡¨ç¤ºåã€ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã€è‡ªå·±ç´¹ä»‹æ–‡ï¼‰  
âœ… ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒæ©Ÿèƒ½ï¼ˆã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒã‚¿ãƒ¼é¸æŠã€æœ‰æ–™ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒã‚¿ãƒ¼ï¼‰  
âœ… ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ï¼ˆã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã€å–ã‚Šè¾¼ã¿ä¸­ï¼‰  
âœ… ãƒ¡ãƒ¢æ©Ÿèƒ½ï¼ˆä½œæˆã€ç·¨é›†ã€å‰Šé™¤ã€å…¬é–‹/éå…¬é–‹è¨­å®šï¼‰  

### é€²è¡Œä¸­ã®æ©Ÿèƒ½
ğŸ”„ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã®å®Ÿè£…  
ğŸ”„ æ—¢å­˜ã€Œãã‚‰ãµã„ã€ãƒ„ãƒ¼ãƒ«ã®ç§»æ¤  
ğŸ”„ åŸºæœ¬çš„ãªå…±æœ‰æ©Ÿèƒ½ã®é–‹ç™º  

### ä»Šå¾Œã®å®Ÿè£…äºˆå®š
ğŸ“… ãƒãƒ¼ãƒ¢ãƒã‚°ãƒ©ãƒ•ãƒ„ãƒ¼ãƒ«ã®ç§»æ¤  
ğŸ“… ãƒ©ã‚¤ãƒ•ã‚²ãƒ¼ãƒ ã®ç§»æ¤  
ğŸ“… æƒ‘æ˜Ÿè»Œé“ãƒ„ãƒ¼ãƒ«ã®ç§»æ¤  
ğŸ“… JSONæ•´å½¢ã€QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãªã©ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«  
ğŸ“… æœ‰æ–™æ©Ÿèƒ½ï¼ˆProæ©Ÿèƒ½ï¼‰ã®å®Ÿè£…  
ğŸ“… ãƒãƒ¼ãƒ æ©Ÿèƒ½ã¨å”åƒãƒ„ãƒ¼ãƒ«ã®é–‹ç™º  

## é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### ç¬¬1ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆåŸºç›¤æ§‹ç¯‰ï¼‰- ç¾åœ¨é€²è¡Œä¸­
- åŸºæœ¬èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå®Œäº†ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ©Ÿèƒ½ï¼ˆå®Œäº†ï¼‰
- ãƒ¡ãƒ¢æ©Ÿèƒ½ï¼ˆå®Œäº†ï¼‰
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½
- æœ€åˆã®ã€Œãã‚‰ãµã„ã€ãƒ„ãƒ¼ãƒ«2ã¤ã®ç§»æ¤ï¼ˆãƒãƒ¼ãƒ¢ãƒã‚°ãƒ©ãƒ•ã€ãƒ©ã‚¤ãƒ•ã‚²ãƒ¼ãƒ ï¼‰
- åŸºæœ¬çš„ãªãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«

### ç¬¬2ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆæ©Ÿèƒ½æ‹¡å……ï¼‰
- è¿½åŠ ãƒ„ãƒ¼ãƒ«ã®ç§»æ¤ã¨å®Ÿè£…
- åŸºæœ¬çš„ãªå…±æœ‰æ©Ÿèƒ½
- ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«æ©Ÿèƒ½ã®å¼·åŒ–
- åˆæœŸã®æœ‰æ–™æ©Ÿèƒ½

### ç¬¬3ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆåç›ŠåŒ–å¼·åŒ–ï¼‰
- ãƒãƒ¼ãƒ æ©Ÿèƒ½
- é«˜åº¦ãªå”åƒãƒ„ãƒ¼ãƒ«
- ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ„ãƒ¼ãƒ«æ‹¡å¼µ

## é–‹ç™ºã‚¬ã‚¤ãƒ‰

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ

#### ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆæ–¹æ³•
1. `/sql/scripts/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ–°ã—ã„SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
2. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
3. `/sql/changes.md` ã«å¤‰æ›´å†…å®¹ã‚’è¨˜éŒ²
4. `/sql/schema.sql` ã‚’æ›´æ–°

#### RLSãƒãƒªã‚·ãƒ¼è¨­å®š
- å„ãƒ†ãƒ¼ãƒ–ãƒ«ã«é©åˆ‡ãªRLSãƒãƒªã‚·ãƒ¼ã‚’è¨­å®š
- åŸºæœ¬æ–¹é‡: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€ç®¡ç†è€…ã¯ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

### ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ©Ÿèƒ½ã®ä½¿ç”¨æ–¹æ³•

#### ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã®å–å¾—
```tsx
import { useProfile } from '@/hooks/useProfile';

function MyComponent() {
  const { profile, loading, error } = useProfile();
  
  if (loading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;
  
  return (
    <div>
      <h1>{profile?.display_name || 'ã‚²ã‚¹ãƒˆ'}</h1>
      {profile?.username && <p>@{profile.username}</p>}
    </div>
  );
}
```

#### ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚«ãƒ¼ãƒ‰ã®ä½¿ç”¨
```tsx
import ProfileCard from '@/components/profile/ProfileCard';

function UsersList({ users }) {
  return (
    <div>
      {users.map(user => (
        <ProfileCard 
          key={user.id} 
          profile={user} 
          showStatus 
          showUsername 
        />
      ))}
    </div>
  );
}
```

### ãƒ¡ãƒ¢æ©Ÿèƒ½ã®ä½¿ç”¨æ–¹æ³•

#### ãƒ¡ãƒ¢ã®å–å¾—ã¨è¡¨ç¤º
```tsx
import { useNotes } from '@/hooks/useNotes';

function NotesListComponent() {
  const { notes, loading, error } = useNotes();
  
  if (loading) return <div>èª­ã¿è¾¼ã¿ä¸­...</div>;
  if (error) return <div>ã‚¨ãƒ©ãƒ¼: {error}</div>;
  
  return (
    <div>
      <h1>ãƒ¡ãƒ¢ä¸€è¦§</h1>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {notes.map(note => (
          <NoteCard key={note.id} note={note} />
        ))}
      </div>
    </div>
  );
}
```

#### ãƒ¡ãƒ¢ã®ä½œæˆ
```tsx
import { useNotes } from '@/hooks/useNotes';
import { NoteFormInput } from '@/types/note';

function CreateNoteComponent() {
  const { createNote } = useNotes();
  
  const handleSubmit = async (data: NoteFormInput) => {
    const { success, error } = await createNote(data);
    if (success) {
      // æˆåŠŸæ™‚ã®å‡¦ç†
    } else {
      // ã‚¨ãƒ©ãƒ¼æ™‚ã®å‡¦ç†
    }
  };
  
  return (
    <NoteForm 
      initialData={{ title: '', content: '', is_public: false }}
      onSubmit={handleSubmit}
      loading={false}
      mode="create"
    />
  );
}
```

### èªè¨¼é–¢é€£ã®é–‹ç™º

#### ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆã®ä½œæˆ
```tsx
'use client';
import ProtectedRoute from '@/components/auth/ProtectedRoute';

export default function ProtectedPage() {
  return (
    <ProtectedRoute>
      <div>ä¿è­·ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„</div>
    </ProtectedRoute>
  );
}
```

#### ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
```tsx
import { AdminOnly } from '@/components/auth/role';

export default function AdminPage() {
  return (
    <AdminOnly redirect={true}>
      <div>ç®¡ç†è€…å°‚ç”¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</div>
    </AdminOnly>
  );
}
```

### ngrokã‚’ä½¿ã£ãŸå¤–éƒ¨å…¬é–‹

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¸€æ™‚çš„ã«å¤–éƒ¨å…¬é–‹ã™ã‚‹å ´åˆï¼š

1. DockerãŒèµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆ`docker-compose up -d`ï¼‰
2. ngrokç®¡ç†ãƒ‘ãƒãƒ«ï¼ˆhttp://localhost:4040ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹
3. ç™ºè¡Œã•ã‚ŒãŸURLã‚’ä½¿ç”¨ã—ã¦å¤–éƒ¨ã‹ã‚‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹

### ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯æ©Ÿèƒ½ã”ã¨ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåˆ†ã‘
- çŠ¶æ…‹ç®¡ç†ã¯åŸºæœ¬çš„ã«Reactã®æ¨™æº–æ©Ÿèƒ½ã‚’ä½¿ç”¨
- TailwindCSSã‚’ä½¿ç”¨ã—ãŸã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
- TypeScriptã®å‹å®šç¾©ã¯å³å¯†ã«è¡Œã†

## ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰

### Cloudflare Pagesã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

#### æº–å‚™
1. Cloudflareã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
2. æ–°ã—ã„Pagesãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¨­å®š

#### ãƒ“ãƒ«ãƒ‰è¨­å®š
- ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰: `npm run build`
- å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: `.next`
- Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³: `18.x`ä»¥ä¸Š

#### ç’°å¢ƒå¤‰æ•°è¨­å®š
å¿…è¦ãªç’°å¢ƒå¤‰æ•°:
- `NEXT_PUBLIC_SUPABASE_URL`: æœ¬ç•ªç’°å¢ƒç”¨Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®URL
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`: æœ¬ç•ªç’°å¢ƒç”¨Supabaseã®åŒ¿åã‚­ãƒ¼

#### æ³¨æ„äº‹é …
1. **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®åˆ¶ç´„**
   - `useSearchParams`ã‚„`usePathname`ãªã©ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€`Suspense`ã§ãƒ©ãƒƒãƒ—ã™ã‚‹

2. **Edge Runtimeå¯¾å¿œ**
   - å‹•çš„ãªAPI routesï¼ˆroute handlersï¼‰ã¯ã€Edge Runtimeã¨ã—ã¦è¨­å®š
   ```typescript
   export const runtime = 'edge';
   ```

3. **ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã®ç¢ºèª**
   - ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼ˆ`npm run build`ï¼‰
   - èªè¨¼ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLãŒæœ¬ç•ªç’°å¢ƒç”¨ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª

---

# Real-time Interactive Platform

A freemium social platform that integrates real-time chat, board games, interactive visualizations and utility tools. This project inherits features from the existing "ãã‚‰ãµã„" (Graph-e) project and extends them further.

## Table of Contents

- [Project Overview](#project-overview)
- [Features](#features)
- [Tech Stack](#tech-stack)
- [Development Environment Setup](#development-environment-setup)
- [Project Structure](#project-structure)
- [Implementation Status](#implementation-status)
- [Development Roadmap](#development-roadmap)
- [Development Guide](#development-guide)
- [Deployment Guide](#deployment-guide)

## Project Overview

This project is a real-time interactive platform built using Next.js, Supabase, Docker, and Cloudflare Pages. Users can communicate through real-time chat while enjoying visual simulations, board games, and using/sharing useful tools. It adopts a freemium model, offering basic features for free and advanced features as paid plans.

## Features

### Inherited "ãã‚‰ãµã„" Features
- **Harmonograph**: Beautiful geometric patterns created by pendulum movements
- **Game of Life**: Life simulation through cellular automaton
- **Planetary Orbit (Dance of Stars)**: Visualization of planetary orbit patterns
- **Euler's Formula 3D Graph**: 3D visualization of mathematical formula
- **Other Tools**: Cross Graph, Survival Strategy Game, and more

### Newly Developed Features
- **Real-time Chat**: Text communication between users
- **Notes Feature**: Create and manage notes with public/private settings
- **Utility Tools**: JSON formatter, QR code generator, etc.
- **Sharing & Collaboration**: Co-editing and real-time sharing of tools
- **User Profiles**: Customizable profiles
- **Content Gallery**: Sharing and browsing user creations

### Free and Paid Features
- **Free Features**: Basic tools, simple chat, basic sharing functionality
- **Paid Features**: Advanced tool settings, unlimited history storage, team features, advanced collaboration tools

For a detailed feature map, please refer to `docs/platform_mindmap.md`.

## Tech Stack

- **Frontend**: Next.js 14.1.3 (React 18), TailwindCSS
- **Backend**: Next.js `use server` functionality + Supabase API
- **Database**: Supabase (PostgreSQL)
- **Real-time Features**: Supabase Realtime Subscriptions
- **Authentication**: Supabase Auth
- **Development Environment**: Docker, Docker Compose
- **Deployment Environment**: Cloudflare Pages
- **Language**: TypeScript
- **Local Tunneling**: ngrok (exposing local development environment)

## Development Environment Setup

### Prerequisites

- Docker and Docker Compose installed
- Git installed
- Supabase account created
- ngrok account (free or paid plan)

### Setup Steps

1. Clone the repository
   ```bash
   git clone <repository-url>
   cd graph_e_rc2
   ```

2. Configure environment variables
   ```bash
   cp .env.example .env
   # Edit the .env file to set necessary environment variables
   ```

   Required environment variables:
   - `NEXT_PUBLIC_SUPABASE_URL`: Supabase project URL
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Supabase anonymous key
   - `NGROK_AUTHTOKEN`: ngrok authentication token (for external access)

3. Build and start Docker containers
   ```bash
   docker-compose up -d
   ```

4. Database Setup
   - Log in to Supabase dashboard
   - Open SQL Editor
   - Execute the contents of `/sql/scripts/user_profiles.sql`
   - If needed, execute `/sql/scripts/notes_table.sql`

5. Access the application
   ```
   http://localhost:3000  # Main application
   http://localhost:4040  # ngrok admin panel (for checking public URL)
   ```

## Project Structure

```
graph_e_rc2/
â”œâ”€â”€ docs/                   # Project design documents
â”‚   â”œâ”€â”€ platform_mindmap.md # Feature mind map
â”‚   â”œâ”€â”€ platform_concept.md # Platform concept details
â”‚   â”œâ”€â”€ existing_features.md # Existing "ãã‚‰ãµã„" features reference
â”‚   â””â”€â”€ supabase_storage_setup.md # Supabase storage setup guide
â”œâ”€â”€ sql/                    # Database related files
â”‚   â”œâ”€â”€ schema.sql          # Latest schema definition
â”‚   â”œâ”€â”€ changes.md          # Database change history
â”‚   â””â”€â”€ scripts/            # SQL scripts for execution
â”œâ”€â”€ src/                    # Source code
â”‚   â”œâ”€â”€ app/                # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ admin/          # Admin functionality
â”‚   â”‚   â”œâ”€â”€ auth/           # Authentication-related routes
â”‚   â”‚   â”œâ”€â”€ chat/           # Chat functionality
â”‚   â”‚   â”œâ”€â”€ games/          # Games functionality
â”‚   â”‚   â”œâ”€â”€ login/          # Login page
â”‚   â”‚   â”œâ”€â”€ notes/          # Notes functionality
â”‚   â”‚   â”‚   â”œâ”€â”€ [id]/       # Note details and edit pages
â”‚   â”‚   â”‚   â””â”€â”€ new/        # New note creation page
â”‚   â”‚   â”œâ”€â”€ settings/       # Settings pages
â”‚   â”‚   â”‚   â””â”€â”€ profile/    # Profile settings
â”‚   â”‚   â””â”€â”€ signup/         # Signup page
â”‚   â”œâ”€â”€ components/         # Common components
â”‚   â”‚   â”œâ”€â”€ auth/           # Authentication-related components
â”‚   â”‚   â”œâ”€â”€ notes/          # Notes-related components
â”‚   â”‚   â”œâ”€â”€ profile/        # Profile-related components
â”‚   â”‚   â”œâ”€â”€ ui/             # Common UI components
â”‚   â”‚   â””â”€â”€ Header.tsx      # Header component
â”‚   â”œâ”€â”€ config/             # Configuration files
â”‚   â”‚   â””â”€â”€ avatars.ts      # Avatar configuration
â”‚   â”œâ”€â”€ hooks/              # Custom hooks
â”‚   â”‚   â”œâ”€â”€ useUserRole.ts  # User role management hook
â”‚   â”‚   â”œâ”€â”€ useProfile.ts   # Profile management hook
â”‚   â”‚   â””â”€â”€ useNotes.ts     # Notes management hook
â”‚   â”œâ”€â”€ lib/                # Utilities
â”‚   â”‚   â””â”€â”€ supabase.ts     # Supabase configuration
â”‚   â””â”€â”€ types/              # Type definitions
â”‚       â”œâ”€â”€ profile.ts      # Profile-related type definitions
â”‚       â””â”€â”€ note.ts         # Notes-related type definitions
â”œâ”€â”€ public/                 # Static files
â”‚   â””â”€â”€ avatars/            # Avatar images
â”‚       â””â”€â”€ samples/        # Sample avatars
â”œâ”€â”€ config/                 # Configuration files
â”œâ”€â”€ bkup/                   # Backup files
â”œâ”€â”€ docker-compose.yml      # Docker Compose configuration
â”œâ”€â”€ Dockerfile              # Docker build configuration
â””â”€â”€ .env.example            # Sample environment variables
```

## Implementation Status

### Completed Features
âœ… Basic project structure setup  
âœ… Docker development environment  
âœ… User authentication system (signup, login, logout)  
âœ… Protected routes (ProtectedRoute)  
âœ… User attribute management (role-based access control)  
âœ… Admin dashboard basic UI  
âœ… RLS policy configuration and fixes  
âœ… User profile functionality (display name, username, bio)  
âœ… Profile image functionality (sample avatar selection, custom avatar for paid users)  
âœ… Online status management (online, offline, busy)  
âœ… Notes functionality (create, edit, delete, public/private settings)  

### In Progress
ğŸ”„ Real-time chat functionality implementation  
ğŸ”„ Migration of existing "ãã‚‰ãµã„" tools  
ğŸ”„ Basic sharing functionality development  

### Planned
ğŸ“… Harmonograph tool migration  
ğŸ“… Game of Life migration  
ğŸ“… Planetary Orbit tool migration  
ğŸ“… Utility tools (JSON formatter, QR code generator, etc.)  
ğŸ“… Paid features (Pro features) implementation  
ğŸ“… Team features and collaboration tools development  

## Development Roadmap

### Phase 1 (Foundation) - Current
- Basic authentication system (Completed)
- User profile functionality (Completed)
- Notes functionality (Completed)
- Real-time chat functionality
- First two "ãã‚‰ãµã„" tools migration (Harmonograph, Game of Life)
- Basic utility tools

### Phase 2 (Feature Expansion)
- Additional tools migration and implementation
- Basic sharing functionality
- Profile feature enhancement
- Initial paid features

### Phase 3 (Monetization Enhancement)
- Team features
- Advanced collaboration tools
- Premium tool expansion

## Development Guide

### Database Operations

#### Creating Tables
1. Create a new SQL file in the `/sql/scripts/` directory
2. Execute the script in the Supabase dashboard
3. Record the changes in `/sql/changes.md`
4. Update `/sql/schema.sql`

#### RLS Policy Configuration
- Set appropriate RLS policies for each table
- Basic principle: Users can only access their own data, administrators can access all data

### Using Profile Features

#### Getting Profile Information
```tsx
import { useProfile } from '@/hooks/useProfile';

function MyComponent() {
  const { profile, loading, error } = useProfile();
  
  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error}</div>;
  
  return (
    <div>
      <h1>{profile?.display_name || 'Guest'}</h1>
      {profile?.username && <p>@{profile.username}</p>}
    </div>
  );
}
```

#### Using Profile Card
```tsx
import ProfileCard from '@/components/profile/ProfileCard';

function UsersList({ users }) {
  return (
    <div>
      {users.map(user => (
        <ProfileCard 
          key={user.id} 
          profile={user} 
          showStatus 
          showUsername 
        />
      ))}
    </div>
  );
}
```

### Using Notes Feature

#### Fetching and Displaying Notes
```tsx
import { useNotes } from '@/hooks/useNotes';

function NotesListComponent() {
  const { notes, loading, error } = useNotes();
  
  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error}</div>;
  
  return (
    <div>
      <h1>Notes List</h1>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {notes.map(note => (
          <NoteCard key={note.id} note={note} />
        ))}
      </div>
    </div>
  );
}
```

#### Creating Notes
```tsx
import { useNotes } from '@/hooks/useNotes';
import { NoteFormInput } from '@/types/note';

function CreateNoteComponent() {
  const { createNote } = useNotes();
  
  const handleSubmit = async (data: NoteFormInput) => {
    const { success, error } = await createNote(data);
    if (success) {
      // Handle success
    } else {
      // Handle error
    }
  };
  
  return (
    <NoteForm 
      initialData={{ title: '', content: '', is_public: false }}
      onSubmit={handleSubmit}
      loading={false}
      mode="create"
    />
  );
}
```

### Authentication Development

#### Creating Protected Routes
```tsx
'use client';
import ProtectedRoute from '@/components/auth/ProtectedRoute';

export default function ProtectedPage() {
  return (
    <ProtectedRoute>
      <div>Protected Content</div>
    </ProtectedRoute>
  );
}
```

#### Role-Based Access Control
```tsx
import { AdminOnly } from '@/components/auth/role';

export default function AdminPage() {
  return (
    <AdminOnly redirect={true}>
      <div>Admin Only Content</div>
    </AdminOnly>
  );
}
```

### External Access with ngrok

To temporarily expose your application externally:

1. Ensure Docker is running (`docker-compose up -d`)
2. Access the ngrok admin panel (http://localhost:4040)
3. Use the issued URL to access your application from external sources

### Code Style
- Components are organized by functionality
- State management primarily uses React's standard features
- Styling with TailwindCSS
- Strict TypeScript type definitions

## Deployment Guide

### Deploying to Cloudflare Pages

#### Preparation
1. Create a Cloudflare account
2. Set up a new Pages project

#### Build Settings
- Build command: `npm run build`
- Output directory: `.next`
- Node.js version: `18.x` or higher

#### Environment Variables
Required environment variables:
- `NEXT_PUBLIC_SUPABASE_URL`: Supabase project URL for production
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Supabase anonymous key for production

#### Important Notes
1. **Client Component Constraints**
   - Hooks like `useSearchParams` and `usePathname` must be wrapped in a `Suspense` boundary

2. **Edge Runtime Configuration**
   - Dynamic API routes (route handlers) must be configured to run with the Edge Runtime
   ```typescript
   export const runtime = 'edge';
   ```

3. **Pre-deployment Checklist**
   - Run build test locally (`npm run build`)
   - Verify that authentication redirect URLs are set to production URLs